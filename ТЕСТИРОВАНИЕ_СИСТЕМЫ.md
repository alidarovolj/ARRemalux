# üß™ –ü–æ–ª–Ω–æ–µ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –ì–∏–±—Ä–∏–¥–Ω–æ–π –°–∏—Å—Ç–µ–º—ã

## ‚úÖ –ß—Ç–æ –ë—ã–ª–æ –î–æ–±–∞–≤–ª–µ–Ω–æ

### **–ù–æ–≤—ã–µ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. ‚úÖ **`ARCameraFrameBridge.cs`** - –ú–æ—Å—Ç –º–µ–∂–¥—É Unity AR Camera –∏ CoreML
2. ‚úÖ **`ARKitFrameBridge.mm`** - Native iOS bridge –¥–ª—è –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ ARKit frames
3. ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω** `CoreMLDepthEstimation.mm` - —É–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ AR frames
4. ‚úÖ **Debug –ª–æ–≥–∏** —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `HybridWallDetector.cs`

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå **–ë–´–õ–û:** "CoreMLDepth: –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ AR frame!"
- ‚úÖ **–¢–ï–ü–ï–†–¨:** ARKitFrameBridge –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç frames –≤ CoreML plugins

---

## üîß –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Unity Scene (5-10 –º–∏–Ω—É—Ç)

### **1.1 –î–æ–±–∞–≤–∏—Ç—å ARCameraFrameBridge**

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É AR —Å—Ü–µ–Ω—É –≤ Unity
2. –ù–∞–π–¥–∏—Ç–µ GameObject —Å `ARCameraManager` (–æ–±—ã—á–Ω–æ "AR Session Origin")
3. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:
   - `Add Component ‚Üí ARCameraFrameBridge`
4. –í Inspector –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:
   ```
   AR Camera Manager: (–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ ARCameraManager)
   AR Camera: (–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ Main Camera)
   Update Interval: 0.1 (10 FPS –¥–ª—è ML)
   Use Direct ARKit Access: ‚úÖ true
   ```

### **1.2 –ù–∞—Å—Ç—Ä–æ–∏—Ç—å ML Managers (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)**

–°–º. `–ì–ò–ë–†–ò–î–ù–ê–Ø_–°–ò–°–¢–ï–ú–ê_SETUP.md` ‚Üí —Ä–∞–∑–¥–µ–ª "–®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å ML Managers"

**–ö—Ä–∞—Ç–∫–æ:**
- –°–æ–∑–¥–∞—Ç—å `DepthEstimationManager` GameObject + –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –°–æ–∑–¥–∞—Ç—å `MLSegmentationManager` GameObject + –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –°–æ–∑–¥–∞—Ç—å `HybridWallDetector` GameObject + –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –°–≤—è–∑–∞—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏ –≤ `WallDetectionAndPainting`

### **1.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ù–∞—Å—Ç—Ä–æ–π–∫–∏**

**WallDetectionAndPainting ‚Üí Inspector:**
```
Hybrid Wall Detector: (—Å—Å—ã–ª–∫–∞ –Ω–∞ HybridWallDetector GameObject)
Use Hybrid Detection: ‚úÖ true
```

**HybridWallDetector ‚Üí Inspector:**
```
Depth Manager: (—Å—Å—ã–ª–∫–∞ –Ω–∞ DepthEstimationManager)
Segmentation Manager: (—Å—Å—ã–ª–∫–∞ –Ω–∞ MLSegmentationManager –∏–ª–∏ None)
AR Plane Manager: (—Å—Å—ã–ª–∫–∞ –Ω–∞ ARPlaneManager)

Min Wall Area: 0.5 –º¬≤
Min Wall Height From Floor: 0.3 –º
```

### **1.4 –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –°—Ü–µ–Ω—É**
```
File ‚Üí Save Scene (Cmd+S)
```

---

## üì± –®–∞–≥ 2: Build –¥–ª—è iOS (15-20 –º–∏–Ω—É—Ç)

### **2.1 Build Settings**
```
File ‚Üí Build Settings
Platform: iOS (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–±—Ä–∞–Ω–∞)
Add Open Scenes (–µ—Å–ª–∏ —Å—Ü–µ–Ω–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞)
```

### **2.2 Player Settings**
```
Player Settings ‚Üí iOS ‚Üí Other Settings:
  Camera Usage Description: "AR camera for wall painting"
  Requires ARKit: ‚úÖ true
  Target minimum iOS Version: 13.0
  Architecture: ARM64
```

### **2.3 Build**
```
Build Settings ‚Üí Build
–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É: NewBuild (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é)
–î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
```

---

## üî® –®–∞–≥ 3: Xcode Setup (5 –º–∏–Ω—É—Ç)

### **3.1 –û—Ç–∫—Ä—ã—Ç—å –ü—Ä–æ–µ–∫—Ç**
```
–û—Ç–∫—Ä–æ–π—Ç–µ: NewBuild/Unity-iPhone.xcodeproj
```

### **3.2 –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: Enable Objective-C Exceptions**

1. –í Xcode –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç **Unity-iPhone** (–ª–µ–≤—ã–π sidebar)
2. Targets ‚Üí **UnityFramework**
3. Build Settings ‚Üí –ø–æ–∏—Å–∫: `"Objective-C Exceptions"`
4. **Enable Objective-C Exceptions: Yes**

‚ö†Ô∏è **–ë–ï–ó –≠–¢–û–ì–û –ü–†–û–ï–ö–¢ –ù–ï –°–û–ë–ï–†–ï–¢–°–Ø!**

### **3.3 Clean Build**
```
Product ‚Üí Clean Build Folder (Shift+Cmd+K)
```

### **3.4 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Signing**
```
General ‚Üí Signing & Capabilities
Team: (–≤–∞—à–∞ Apple Developer team)
Bundle Identifier: (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID)
```

### **3.5 Build & Run**
```
1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ iPhone
2. –í—ã–±–µ—Ä–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ Xcode (top bar)
3. Product ‚Üí Run (Cmd+R)
4. –î–æ–∂–¥–∏—Ç–µ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω
```

---

## üß™ –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (20-30 –º–∏–Ω—É—Ç)

### **4.1 –ü–µ—Ä–≤—ã–π –ó–∞–ø—É—Å–∫ - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**

**–û—Ç–∫—Ä–æ–π—Ç–µ Xcode Console:**
```
View ‚Üí Debug Area ‚Üí Activate Console (Cmd+Shift+C)
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:**

```
‚úÖ [ARCameraFrameBridge] ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ [DepthEstimation] –ó–∞–≥—Ä—É–∑–∫–∞ Depth Anything V2 –º–æ–¥–µ–ª–∏...
‚úÖ [DepthEstimation] ‚úÖ CoreML Depth –º–æ–¥–µ–ª—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!
‚úÖ [HybridWallDetector] ‚úÖ –ü–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ AR Plane events
‚úÖ [WallDetection] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
```

**–ï—Å–ª–∏ –ù–ï–¢ —ç—Ç–∏—Ö –ª–æ–≥–æ–≤:**
- ‚ùå –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ GameObject –∞–∫—Ç–∏–≤–Ω—ã –≤ —Å—Ü–µ–Ω–µ
- ‚ùå –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –º–æ–¥–µ–ª—å `DepthAnythingV2SmallF16P6.mlpackage` –≤ `StreamingAssets/`

### **4.2 –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –°—Ç–µ–Ω**

**–î–µ–π—Å—Ç–≤–∏—è:**
1. **–ù–∞–ø—Ä–∞–≤—å—Ç–µ** —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–∞ —Å—Ç–µ–Ω—É (1-2 –º–µ—Ç—Ä–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ)
2. **–ú–µ–¥–ª–µ–Ω–Ω–æ** –¥–≤–∏–≥–∞–π—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –∏–∑ —Å—Ç–æ—Ä–æ–Ω—ã –≤ —Å—Ç–æ—Ä–æ–Ω—É
3. **–î–µ—Ä–∂–∏—Ç–µ** –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ –∫ —Å—Ç–µ–Ω–µ (~90¬∞)
4. **–•–æ—Ä–æ—à–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ** –∫—Ä–∏—Ç–∏—á–Ω–æ!

**–°–æ–≤–µ—Ç—ã:**
- ‚úÖ –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –ø–ª–∞–≤–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è (–∫–∞–∫ –≤–∏–¥–µ–æ—Å—ä–µ–º–∫–∞)
- ‚úÖ –°—Ç–µ–Ω—ã —Å —Ç–µ–∫—Å—Ç—É—Ä–æ–π (–∫–∞—Ä—Ç–∏–Ω—ã, –ø–æ—Å—Ç–µ—Ä—ã, —Ä–æ–∑–µ—Ç–∫–∏ –ø–æ–º–æ–≥–∞—é—Ç)
- ‚úÖ –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ 2-3 –º–µ—Ç—Ä–∞ —Å—Ç–µ–Ω—ã
- ‚ùå –ò–∑–±–µ–≥–∞–π—Ç–µ –±—ã—Å—Ç—Ä—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π
- ‚ùå –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç–µ —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ (<0.5–º)

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ (ARKit –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –ø–ª–æ—Å–∫–æ—Å—Ç–∏):**

```
üÜï [HybridWallDetector] üÜï ARKit –Ω–∞—à–µ–ª 1 –Ω–æ–≤—ã—Ö –ø–ª–æ—Å–∫–æ—Å—Ç–µ–π
üìê [HybridWallDetector] üìê –ü–ª–æ—Å–∫–æ—Å—Ç—å: ID=..., Alignment=Vertical, Size=0.3√ó0.4–º, Area=0.12–º¬≤
‚è≥ [HybridWallDetector] ‚è≥ –û–∂–∏–¥–∞–µ–º —Ä–æ—Å—Ç–∞: 0.12–º¬≤ < 0.5–º¬≤

(–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å...)

üîÑ [HybridWallDetector] üîÑ ARKit –æ–±–Ω–æ–≤–∏–ª 1 –ø–ª–æ—Å–∫–æ—Å—Ç–µ–π
üìê [HybridWallDetector] üìê –ü–ª–æ—Å–∫–æ—Å—Ç—å: Alignment=Vertical, Size=0.8√ó0.9–º, Area=0.72–º¬≤
‚úÖ [HybridWallDetector] ‚úÖ –°–¢–ï–ù–ê –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞: 0.8–º √ó 0.9–º, depth: 0.75, confidence: 0.82
```

**–ï—Å–ª–∏ ARKit –ù–ï –Ω–∞—Ö–æ–¥–∏—Ç –ø–ª–æ—Å–∫–æ—Å—Ç–∏:**
- üìã –°–º. —Ä–∞–∑–¥–µ–ª "Troubleshooting" –Ω–∏–∂–µ

### **4.3 –í–∏–∑—É–∞–ª—å–Ω–∞—è –ò–Ω–¥–∏–∫–∞—Ü–∏—è**

**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω–µ:**
- ‚úÖ –í–∏–¥–µ–æ —Å AR –∫–∞–º–µ—Ä—ã
- ‚úÖ **–ö—Ä–∞—Å–Ω—ã–µ/—Ä–æ–∑–æ–≤—ã–µ** –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –Ω–∞ —Å—Ç–µ–Ω–∞—Ö
- ‚úÖ **–ñ–µ–ª—Ç—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã** –≤–æ–∫—Ä—É–≥ —Å—Ç–µ–Ω (–µ—Å–ª–∏ `showWallBorders = true`)

### **4.4 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –û–∫—Ä–∞—Å–∫–∏**

**–ü–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å—Ç–µ–Ω—ã:**
1. **–ö–ª–∏–∫–Ω–∏—Ç–µ** –Ω–∞ –∫—Ä–∞—Å–Ω—É—é –ø–ª–æ—Å–∫–æ—Å—Ç—å (—Å—Ç–µ–Ω—É)
2. –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è **–∫—Ä–∞—Å–Ω–∞—è —Å—Ñ–µ—Ä–∞** (paint mark)
3. –¢–µ–ª–µ—Ñ–æ–Ω –¥–æ–ª–∂–µ–Ω **–≤–∏–±—Ä–∏—Ä–æ–≤–∞—Ç—å** (haptic feedback)

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:**

```
‚úÖ [WallDetection] ‚úÖ –ì–ò–ë–†–ò–î–ù–´–ô: –°—Ç–µ–Ω–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞! Confidence: 0.82
   ‚Ä¢ Depth consistency: 0.95
   ‚Ä¢ Non-wall objects: –ù–µ—Ç
   ‚Ä¢ Confidence: 0.82
‚úÖ [WallDetection] üé® –ì–∏–±—Ä–∏–¥–Ω–∞—è –æ–∫—Ä–∞—Å–∫–∞
‚úÖ [WallDetection] –°–æ–∑–¥–∞–Ω–∞ –º–µ—Ç–∫–∞ –∫—Ä–∞—Å–∫–∏ #1
```

**–ï—Å–ª–∏ –∫–ª–∏–∫ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–ª–∏–∫–∞–µ—Ç–µ **–Ω–∞ –∫—Ä–∞—Å–Ω—É—é –ø–ª–æ—Å–∫–æ—Å—Ç—å**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –¥–ª—è debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

### **4.5 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –§–∏–ª—å—Ç—Ä–∞—Ü–∏–∏**

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫–ª–∏–∫–Ω—É—Ç—å:**
- ‚ùå **–ù–∞ –ø–æ–ª** ‚Üí –¥–æ–ª–∂–µ–Ω –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (Horizontal plane)
- ‚ùå **–ù–∞ –¥–≤–µ—Ä—å** ‚Üí –¥–æ–ª–∂–µ–Ω –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (—É–∑–∫–∞—è –ø–ª–æ—Å–∫–æ—Å—Ç—å)
- ‚ùå **–ù–∞ –º–µ–±–µ–ª—å** ‚Üí –¥–æ–ª–∂–µ–Ω –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (–Ω–∏–∑–∫–∏–π centerY –∏–ª–∏ segmentation filter)

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ –ù–ï –Ω–∞ —Å—Ç–µ–Ω—É:**

```
‚ùå [HybridWallDetector] ‚ùå –ò–≥–Ω–æ—Ä: –ù–ï –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è (alignment=Horizontal)
–∏–ª–∏
‚ùå [WallDetection] ‚ùå –ì–ò–ë–†–ò–î–ù–´–ô: –ö–ª–∏–∫ –ù–ï –Ω–∞ —Å—Ç–µ–Ω–µ!
```

---

## üêõ Troubleshooting

### **–ü—Ä–æ–±–ª–µ–º–∞ 1: "ARKit –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –ø–ª–æ—Å–∫–æ—Å—Ç–∏"**

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ù–µ—Ç –ª–æ–≥–æ–≤ `üÜï ARKit –Ω–∞—à–µ–ª...`
- –ù–µ—Ç –∫—Ä–∞—Å–Ω—ã—Ö –ø–ª–æ—Å–∫–æ—Å—Ç–µ–π –Ω–∞ —ç–∫—Ä–∞–Ω–µ

**–ü—Ä–∏—á–∏–Ω—ã –∏ –†–µ—à–µ–Ω–∏—è:**

#### A) –ü–ª–æ—Ö–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è ARKit
```
‚ùå –ü–ª–æ—Ö–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ ‚Üí –í–∫–ª—é—á–∏—Ç–µ —Å–≤–µ—Ç
‚ùå –û–¥–Ω–æ—Ä–æ–¥–Ω–∞—è –±–µ–ª–∞—è —Å—Ç–µ–Ω–∞ ‚Üí –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ —Å—Ç–µ–Ω—É —Å –∫–∞—Ä—Ç–∏–Ω–∞–º–∏/–ø–æ—Å—Ç–µ—Ä–∞–º–∏
‚ùå –ë—ã—Å—Ç—Ä—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è ‚Üí –î–≤–∏–≥–∞–π—Ç–µ—Å—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ
‚ùå –°–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ ‚Üí –û—Ç–æ–π–¥–∏—Ç–µ –Ω–∞ 1-2 –º–µ—Ç—Ä–∞
```

#### B) ARKit –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
```
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   [ARSession] Session started (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å!)

2. –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - ARSession Origin –∞–∫—Ç–∏–≤–µ–Ω –≤ —Å—Ü–µ–Ω–µ
   - ARPlaneManager –≤–∫–ª—é—á–µ–Ω (Enabled)
   - Detection Mode: Everything –∏–ª–∏ Horizontal + Vertical
```

#### C) iOS permissions
```
Settings ‚Üí Privacy ‚Üí Camera ‚Üí [–í–∞—à–µ App]
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ‚úÖ Enabled
```

### **–ü—Ä–æ–±–ª–µ–º–∞ 2: "Depth –º–æ–¥–µ–ª—å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è"**

**–°–∏–º–ø—Ç–æ–º—ã:**
```
‚ùå [DepthEstimation] ‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å CoreML Depth –º–æ–¥–µ–ª—å!
```

**–†–µ—à–µ–Ω–∏—è:**

#### A) –ú–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Unity:
ls -lh Assets/StreamingAssets/DepthAnythingV2SmallF16P6.mlpackage

# –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ:
cp -r Assets/ML/DepthAnythingV2SmallF16P6.mlpackage Assets/StreamingAssets/
```

#### B) –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å
```csharp
// –í DepthEstimationManager.cs –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
string modelName = "DepthAnythingV2SmallF16P6.mlpackage";  // ‚Üê —Ç–æ—á–Ω–æ–µ –∏–º—è!
```

#### C) CoreML compilation failed
```
Xcode ‚Üí Build Phases ‚Üí Copy Bundle Resources
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ .mlpackage –≤–∫–ª—é—á–µ–Ω –≤ bundle
```

### **–ü—Ä–æ–±–ª–µ–º–∞ 3: "Objective-C Exceptions Error"**

**–°–∏–º–ø—Ç–æ–º—ã:**
```
error: Cannot use '@try' with Objective-C exceptions disabled
```

**–†–µ—à–µ–Ω–∏–µ:**
```
Xcode ‚Üí UnityFramework ‚Üí Build Settings
Enable Objective-C Exceptions: YES (‚ö†Ô∏è –í–ê–ñ–ù–û!)
Product ‚Üí Clean Build Folder
Product ‚Üí Run
```

### **–ü—Ä–æ–±–ª–µ–º–∞ 4: "–í—Å–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ furniture"**

**–°–∏–º–ø—Ç–æ–º—ã:**
```
‚ö†Ô∏è [HybridWallDetector] ü™ë –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –º–µ–±–µ–ª—å –≤ —Ä–µ–≥–∏–æ–Ω–µ
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- DeepLabV3 –æ–±—É—á–µ–Ω–∞ –Ω–∞ PASCAL VOC (–Ω–µ—Ç –∫–ª–∞—Å—Å–∞ "wall")

**–†–µ—à–µ–Ω–∏–µ (–í—Ä–µ–º–µ–Ω–Ω—ã–π Workaround):**

–í Unity Inspector ‚Üí `HybridWallDetector`:
```
Filter People: ‚ùå false (–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å)
Filter Furniture: ‚ùå false
Filter Electronics: ‚ùå false
```

–ò–ª–∏ –≤ –∫–æ–¥–µ `HybridWallDetector.cs`:
```csharp
// Line ~242
private bool CheckForNonWallObjects(Vector2 normalizedPos)
{
    // –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –¥–ª—è —Ç–µ—Å—Ç–∞
    return false;
}
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –†–µ—à–µ–Ω–∏–µ (Future):**
- –ó–∞–º–µ–Ω–∏—Ç—å DeepLabV3 ‚Üí ADE20K –º–æ–¥–µ–ª—å (–∏–º–µ–µ—Ç –∫–ª–∞—Å—Å "wall")

### **–ü—Ä–æ–±–ª–µ–º–∞ 5: "AR Frame –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ CoreML"**

**–°–∏–º–ø—Ç–æ–º—ã:**
```
‚è≥ [CoreMLDepth] ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ AR frame... (–ø–æ–ø—ã—Ç–∫–∞ 1)
‚è≥ [CoreMLDepth] ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ AR frame... (–ø–æ–ø—ã—Ç–∫–∞ 2)
```

**–†–µ—à–µ–Ω–∏–µ:**

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `ARCameraFrameBridge` –∞–∫—Ç–∏–≤–µ–Ω:
```
1. Unity ‚Üí Hierarchy ‚Üí –Ω–∞–π–¥–∏—Ç–µ GameObject —Å ARCameraFrameBridge
2. Inspector ‚Üí Enabled: ‚úÖ
3. Use Direct ARKit Access: ‚úÖ true
4. Update Interval: 0.1
```

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:
```
1. –í ARCameraFrameBridge ‚Üí Use Direct ARKit Access: ‚ùå false
2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
3. –≠—Ç–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç –Ω–∞ RenderTexture fallback –º–µ—Ç–æ–¥
```

### **–ü—Ä–æ–±–ª–µ–º–∞ 6: "–§–∏–ª—å—Ç—Ä—ã —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–µ"**

**–°–∏–º–ø—Ç–æ–º—ã:**
```
‚è≥ [HybridWallDetector] ‚è≥ –û–∂–∏–¥–∞–µ–º —Ä–æ—Å—Ç–∞: 0.45–º¬≤ < 0.5–º¬≤
‚ùå [HybridWallDetector] ‚ùå –ò–≥–Ω–æ—Ä: —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–æ...
```

**–†–µ—à–µ–Ω–∏–µ:**

–í Unity Inspector ‚Üí `HybridWallDetector`:
```
Min Wall Area: 0.3 (–±—ã–ª–æ 0.5)
Min Wall Height From Floor: 0.2 (–±—ã–ª–æ 0.3)
```

–í Unity Inspector ‚Üí `WallDetectionAndPainting`:
```
Min Wall Area: 0.3
Min Wall Height: 0.4 (–±—ã–ª–æ 0.8)
Min Aspect Ratio: 0.3 (–±—ã–ª–æ 0.5)
Min Center Height Y: 0.2
```

**–ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π!

---

## üìä –û–∂–∏–¥–∞–µ–º–∞—è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**iPhone 13/14 (A15/A16 Bionic):**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | Inference Time | FPS | Load |
|-----------|----------------|-----|------|
| AR Planes (ARKit) | Native | 60 FPS | Low |
| Depth Anything V2 | 26-70ms | 10 FPS | Medium |
| Segmentation (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω) | 60-70ms | 5 FPS | Medium |
| **–ò—Ç–æ–≥–æ** | ~40ms avg | ~25 FPS | Medium |

**–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚úÖ AR camera feed: –ø–ª–∞–≤–Ω—ã–π (60 FPS)
- ‚úÖ Plane detection: responsive (~60 FPS)
- ‚úÖ ML inference: –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π (–∫–∞–∂–¥—ã–µ 0.1-0.2s)

---

## ‚úÖ Checklist –¥–ª—è –£—Å–ø–µ—à–Ω–æ–≥–æ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **–ü–µ—Ä–µ–¥ –°–±–æ—Ä–∫–æ–π:**
- [ ] `ARCameraFrameBridge` –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ AR Session Origin
- [ ] –í—Å–µ ML Managers —Å–æ–∑–¥–∞–Ω—ã –∏ —Å—Å—ã–ª–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- [ ] `useHybridDetection = true` –≤ WallDetectionAndPainting
- [ ] –ú–æ–¥–µ–ª—å `DepthAnythingV2SmallF16P6.mlpackage` –≤ StreamingAssets
- [ ] –°—Ü–µ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

### **–í Xcode:**
- [ ] **Objective-C Exceptions: Yes** (UnityFramework)
- [ ] Clean Build Folder –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] Device –ø–æ–¥–∫–ª—é—á–µ–Ω –∏ unlocked
- [ ] Signing –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### **–í–æ –í—Ä–µ–º—è –¢–µ—Å—Ç–∞:**
- [ ] –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ ] ARKit –Ω–∞—Ö–æ–¥–∏—Ç –ø–ª–æ—Å–∫–æ—Å—Ç–∏ (–ª–æ–≥–∏ `üÜï ARKit –Ω–∞—à–µ–ª...`)
- [ ] –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è (–∫—Ä–∞—Å–Ω—ã–µ)
- [ ] HybridWallDetector –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Å—Ç–µ–Ω—ã (–ª–æ–≥–∏ `‚úÖ –°–¢–ï–ù–ê –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞`)
- [ ] –ö–ª–∏–∫ –ø–æ —Å—Ç–µ–Ω–µ —Å–æ–∑–¥–∞–µ—Ç paint mark (–∫—Ä–∞—Å–Ω–∞—è —Å—Ñ–µ—Ä–∞)
- [ ] –ö–ª–∏–∫ –ø–æ –ø–æ–ª—É/–º–µ–±–µ–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è

---

## üéØ –ü–æ—Å–ª–µ –£—Å–ø–µ—à–Ω–æ–≥–æ –¢–µ—Å—Ç–∞

### **–ï—Å–ª–∏ –í—Å—ë –†–∞–±–æ—Ç–∞–µ—Ç:**

1. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** - –¥–æ–±–∞–≤—å—Ç–µ debug overlay –¥–ª—è ML:
   - –°–º. `–í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø_ML.md`
   
2. **UI –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - —Å–ª–∞–π–¥–µ—Ä—ã –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
   - Min wall area
   - Confidence thresholds
   - Filter toggles

3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –µ—Å–ª–∏ FPS –Ω–∏–∑–∫–∏–π:
   - –°–Ω–∏–∑–∏—Ç—å inference interval: 0.1s ‚Üí 0.2s
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 256x256 –≤–º–µ—Å—Ç–æ 512x512

### **–ï—Å–ª–∏ –ù–µ –†–∞–±–æ—Ç–∞–µ—Ç:**

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–°–ï –ª–æ–≥–∏** –∏–∑ Xcode Console
2. **–°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã** Inspector settings
3. **–û–ø–∏—à–∏—Ç–µ —Å–∏–º–ø—Ç–æ–º—ã:**
   - –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ?
   - –ö–∞–∫–∏–µ –ª–æ–≥–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è?
   - –ù–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –ø—Ä–æ–±–ª–µ–º–∞?

---

## üìû –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. ‚úÖ **–û—Ç–º–µ—Ç—å—Ç–µ TODO –∫–∞–∫ completed**
2. üìù **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ª–æ–≥–∏** —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –¥–ª—è reference
3. üé® **–î–æ–±–∞–≤—å—Ç–µ UI** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
4. üöÄ **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
5. üì± **–ó–∞–º–µ–Ω–∏—Ç—å DeepLabV3 ‚Üí ADE20K** (–¥–ª—è production)

---

## üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é!

–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç - –≤—ã —Å–æ–∑–¥–∞–ª–∏ **state-of-the-art** AR wall detection —Å–∏—Å—Ç–µ–º—É!

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- ‚úÖ Depth Anything V2 (19MB)
- ‚úÖ ARKit Plane Detection
- ‚úÖ Semantic Segmentation (DeepLabV3)
- ‚úÖ –ì–∏–±—Ä–∏–¥–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ Real-time inference (~25 FPS)

**–£–¥–∞—á–∏! üöÄ**

