–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–ª–æ—Å–∫–æ—Å—Ç–µ–π ARKit/AR FoundationI. –£–ø—Ä–∞–≤–ª—è—é—â–µ–µ —Ä–µ–∑—é–º–µ: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—èA. –î–∏–∞–≥–Ω–æ–∑–ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∞—à–µ–≥–æ –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–µ–≥–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –±—Ä–∏—Ñ–∞, –ª–æ–≥–æ–≤ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (Image 1-6) –≤—ã—è–≤–∏–ª –ø—Ä–æ–±–ª–µ–º—É, –∏–º–µ—é—â—É—é –¥–≤–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ—Ä–Ω—è:–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ ARKit (–±–µ–∑ LiDAR): –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–ª–∫–∏–≤–∞–µ—Ç—Å—è —Å "—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–ª–µ–ø–æ—Ç–æ–π". –ê–ª–≥–æ—Ä–∏—Ç–º—ã SLAM (Simultaneous Localization and Mapping) –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –±–µ–∑ LiDAR –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≥–µ–æ–º–µ—Ç—Ä–∏—é ‚Äî –ø–ª–æ—Å–∫–∏–µ, —Ç–µ–∫—Å—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏. –û–¥–Ω–∞–∫–æ –æ–Ω–∏ –Ω–µ –æ–±–ª–∞–¥–∞—é—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –î–ª—è ARKit —Å—Ç–µ–Ω–∞, –¥–≤–µ—Ä—å (Image 1, 2, 4), —à–∫–∞—Ñ –∏–ª–∏ –¥–∞–∂–µ –±–æ–∫–æ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –±–æ–ª—å—à–æ–≥–æ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞ (Image 6) ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ ARPlane —Å –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º PlaneAlignment.Vertical.–û—à–∏–±–∫–∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –°–æ—Å—Ç–æ—è–Ω–∏–µ–º (State Management): –í–∞—à–∞ —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª ARPlane. –ê–Ω–æ–º–∞–ª–∏—è, –∫–æ—Ç–æ—Ä—É—é –≤—ã –Ω–∞–±–ª—é–¥–∞–µ—Ç–µ (–ø–ª–æ—Å–∫–æ—Å—Ç—å 0.51 –º¬≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä 1.0 –º¬≤), –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π –≤ –ª–æ–≥–∏–∫–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è. –≠—Ç–æ —Å–∏–º–ø—Ç–æ–º —Ç–æ–≥–æ, —á—Ç–æ –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è (args.updated) –∏ —É–¥–∞–ª–µ–Ω–∏—è (args.removed) –ø–ª–æ—Å–∫–æ—Å—Ç–µ–π, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ "–±–ª—É–∂–¥–∞—é—â–∏–º" (stale) –¥–∞–Ω–Ω—ã–º.B. –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–ü—Ä–æ—Å—Ç–æ–π –≤—ã–±–æ—Ä –º–µ–∂–¥—É –†–µ—à–µ–Ω–∏–µ–º A (–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è) –∏ B (ML –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è) –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º. –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è, –ø–æ—ç—Ç–∞–ø–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è ‚Äî –¢—Ä–µ—Ö—ç—Ç–∞–ø–Ω—ã–π –ì–∏–±—Ä–∏–¥–Ω—ã–π –ü–æ–¥—Ö–æ–¥ ("–ê–ª—å—Ñ–∞-–î–µ–ª—å—Ç–∞-–ë—Ä–∞–≤–æ"). –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º, –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é –∏ –≤—ã—Å–æ—á–∞–π—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é, –Ω–∞–ø—Ä—è–º—É—é –æ—Ç–≤–µ—á–∞—è –≤–∞—à–µ–º—É –≥–ª–∞–≤–Ω–æ(–º—É) –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É: –¢–æ—á–Ω–æ—Å—Ç—å > –ü–æ–ª–Ω–æ—Ç–∞ (—Ç.–µ. –ª—É—á—à–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç–µ–Ω—É, —á–µ–º –æ—à–∏–±–æ—á–Ω–æ "–ø–æ–∫—Ä–∞—Å–∏—Ç—å" –¥–≤–µ—Ä—å).–≠—Ç–∞–ø 1: –†–µ—à–µ–Ω–∏–µ "–ê–ª—å—Ñ–∞" ‚Äî –ù–∞–¥–µ–∂–Ω–∞—è –≠–≤—Ä–∏—Å—Ç–∏–∫–∞ (–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ, < 1 –¥–Ω—è):–î–µ–π—Å—Ç–≤–∏–µ: –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –≤ OnPlanesChanged –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π updated –∏ removed. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–ø–æ–≤—ã—à–µ–Ω–∏–µ minWallArea, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ minAspectRatio).–†–µ–∑—É–ª—å—Ç–∞—Ç: –£—Å—Ç—Ä–∞–Ω—è–µ—Ç –≤–∞—à –±–∞–≥ 0.51 –º¬≤. –û—Ç—Å–µ–∫–∞–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ—á–µ–≤–∏–¥–Ω—ã—Ö –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (–¥–≤–µ—Ä–Ω—ã–µ –∫–æ—Å—è–∫–∏, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –¥–≤–µ—Ä–µ–π).–≠—Ç–∞–ø 2: –†–µ—à–µ–Ω–∏–µ "–î–µ–ª—å—Ç–∞" ‚Äî –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ –ì–ª—É–±–∏–Ω–µ (–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ, < 1 –Ω–µ–¥–µ–ª–∏):–î–µ–π—Å—Ç–≤–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Depth API (–∫–æ—Ç–æ—Ä–æ–µ –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ iPhone 13/14 –±–µ–∑ LiDAR ) –¥–ª—è –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏.–õ–æ–≥–∏–∫–∞: –£ –Ω–∞—Å—Ç–æ—è—â–µ–π —Å—Ç–µ–Ω—ã –¥–∏—Å–ø–µ—Ä—Å–∏—è –≥–ª—É–±–∏–Ω—ã –Ω–∏–∑–∫–∞—è (–æ–Ω–∞ –ø–ª–æ—Å–∫–∞—è). –£ —Å—Ç–µ–Ω—ã —Å –º–µ–±–µ–ª—å—é (Image 6), –¥–≤–µ—Ä–Ω–æ–≥–æ –∫–æ—Å—è–∫–∞ (Image 4) –∏–ª–∏ —É—Ç–æ–ø–ª–µ–Ω–Ω–æ–π –¥–≤–µ—Ä–∏ (Image 2) –¥–∏—Å–ø–µ—Ä—Å–∏—è –≥–ª—É–±–∏–Ω—ã –≤—ã—Å–æ–∫–∞—è.–†–µ–∑—É–ª—å—Ç–∞—Ç: –û—Ç—Å–µ–∫–∞–µ—Ç ~90% –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π, –≤—ã–∑–≤–∞–Ω–Ω—ã—Ö –Ω–µ-–ø–ª–æ—Å–∫–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏, –±–µ–∑ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ ML.–≠—Ç–∞–ø 3: –†–µ—à–µ–Ω–∏–µ "–ë—Ä–∞–≤–æ" ‚Äî –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è (–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ, 2-3 –Ω–µ–¥–µ–ª–∏):–î–µ–π—Å—Ç–≤–∏–µ: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–π –≤–∞–º–∏ ML-–º–æ–¥–µ–ª–∏ (SegFormer-B0) 2 –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏.–õ–æ–≥–∏–∫–∞: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è (—á—Ç–æ –¥–æ—Ä–æ–≥–æ), –∞ –¥–ª—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–ª–æ—Å–∫–æ—Å—Ç–∏: "–Ø–≤–ª—è—é—Ç—Å—è –ª–∏ >80% –ø–∏–∫—Å–µ–ª–µ–π —ç—Ç–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç–∏ '—Å—Ç–µ–Ω–æ–π'?".4–†–µ–∑—É–ª—å—Ç–∞—Ç: –†–µ—à–∞–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è 5-10% —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ (–¥–≤–µ—Ä–∏ –≤—Ä–æ–≤–µ–Ω—å —Å–æ —Å—Ç–µ–Ω–æ–π, –±–æ–ª—å—à–∏–µ –∫–∞—Ä—Ç–∏–Ω—ã), –¥–æ—Å—Ç–∏–≥–∞—è >98% —Ç–æ—á–Ω–æ—Å—Ç–∏.C. –û–∂–∏–¥–∞–µ–º—ã–π –†–µ–∑—É–ª—å—Ç–∞—Ç–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –≠—Ç–∞–ø–æ–≤ 1 –∏ 2 (–≤ —Ç–µ—á–µ–Ω–∏–µ <1 –Ω–µ–¥–µ–ª–∏) –æ–±–µ—Å–ø–µ—á–∏—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –≤–∞—à–∏—Ö –∫–ª—é—á–µ–≤—ã—Ö –±–∏–∑–Ω–µ—Å-—Ü–µ–ª–µ–π: Precision > 90-95% (–ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –Ω–∞ –¥–≤–µ—Ä—è—Ö –ø–æ—á—Ç–∏ –Ω–µ –±—É–¥–µ—Ç) –ø—Ä–∏ Recall ~ 60-70% (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–∞–ª–µ–Ω—å–∫–∏–µ –∏–ª–∏ –∑–∞–≥—Ä–æ–º–æ–∂–¥–µ–Ω–Ω—ã–µ —Å—Ç–µ–Ω—ã –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã). –≠—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–µ–º—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É üî¥. –≠—Ç–∞–ø 3 ‚Äî —ç—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏.II. –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ê–Ω–æ–º–∞–ª–∏–∏ 0.51 –º¬≤–í–∞—à–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –ø–ª–æ—Å–∫–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–æ–º 0.51 –º¬≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä minWallArea = 1.0f, —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω–æ–π —É–ª–∏–∫–æ–π. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ –Ω–∞ —Å–±–æ–π —Ñ–∏–ª—å—Ç—Ä–∞, –∞ –Ω–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ ARPlane –≤ –≤–∞—à–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.A. –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª ARPlane: Added vs. Updated–ü–ª–æ—Å–∫–æ—Å—Ç–∏ –≤ AR Foundation (–∏ –≤ ARKit/ARCore) –Ω–µ —è–≤–ª—è—é—Ç—Å—è —Å—Ç–∞—Ç–∏—á–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏. –û–Ω–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ç–∫–∏–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π ARPlaneManager.6 –°–æ–±—ã—Ç–∏–µ ARPlaneManager.planesChanged –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç—Ä–∏ —Å–ø–∏—Å–∫–∞: added, updated –∏ removed.8Added (–î–æ–±–∞–≤–ª–µ–Ω–æ): ARKit –æ–±–Ω–∞—Ä—É–∂–∏–ª –Ω–∞—á–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å –ø–ª–æ—Å–∫–æ—Å—Ç–∏. –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –µ–µ plane.size –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –º–∞–ª –∏ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å—é –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å.9Updated (–û–±–Ω–æ–≤–ª–µ–Ω–æ): –í –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∫–∞–¥—Ä–∞—Ö, –ø–æ –º–µ—Ä–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, ARKit —Ä–∞—Å—à–∏—Ä—è–µ—Ç, —É—Ç–æ—á–Ω—è–µ—Ç –∏ –∏–Ω–æ–≥–¥–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏–ª–∏ —É–º–µ–Ω—å—à–∞–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –ø–ª–æ—Å–∫–æ—Å—Ç–∏. –°–æ–±—ã—Ç–∏–µ updated —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–∞—Å—Ç–æ.9Removed (–£–¥–∞–ª–µ–Ω–æ): ARKit –ø–æ—Ç–µ—Ä—è–ª –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç—Ç–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç–∏, –∏–ª–∏ –æ–Ω–∞ –±—ã–ª–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∞ —Å –¥—Ä—É–≥–æ–π.–í–∞—à —Ç–µ–∫—É—â–∏–π –∫–æ–¥ WallDetectionAndPainting.cs (—Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º—É –±—Ä–∏—Ñ—É) –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ planesChanged, –Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ args.added (–ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ–º–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç updated –∏–ª–∏ removed).B. –î–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ê–Ω–æ–º–∞–ª–∏–∏ 0.51 –º¬≤–í–∞—à–∞ –ì–∏–ø–æ—Ç–µ–∑–∞ 4 –≤–µ—Ä–Ω–∞ –ª–∏—à—å –æ—Ç—á–∞—Å—Ç–∏. –§–∏–ª—å—Ç—Ä –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –æ–Ω —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.–ù–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –±–∞–≥–∞ (–ö–æ–º–±–∏–Ω–∞—Ü–∏—è –ì–∏–ø–æ—Ç–µ–∑ 2 –∏ 4):–ö–∞–¥—Ä N (–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ): –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–≤–æ–¥–∏—Ç –∫–∞–º–µ—Ä—É –Ω–∞ –¥–≤–µ—Ä–Ω–æ–π –∫–æ—Å—è–∫ (Image 4). ARKit –≤–∏–¥–∏—Ç —Ç–µ–∫—Å—Ç—É—Ä—É –∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é –ø–ª–æ—Å–∫–æ—Å—Ç—å, –≤–∫–ª—é—á–∞—é—â—É—é –∏ –∫–æ—Å—è–∫, –∏ —á–∞—Å—Ç—å —Å—Ç–µ–Ω—ã —Ä—è–¥–æ–º —Å –Ω–∏–º. –≠—Ç–∞ –Ω–∞—á–∞–ª—å–Ω–∞—è –ø–ª–æ—Å–∫–æ—Å—Ç—å –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä, —Å–∫–∞–∂–µ–º, 1.1 –º¬≤.–ö–∞–¥—Ä N (–û–±—Ä–∞–±–æ—Ç–∫–∞ Added):–°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç OnPlanesChanged —Å —ç—Ç–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç—å—é –≤ —Å–ø–∏—Å–∫–µ args.added.–í–∞—à ShouldProcessPlane(plane) –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è.planeArea (1.1 –º¬≤) > minWallArea (1.0 –º¬≤) -> true.planeSize.y (2.05 –º) > minWallHeight (0.8 –º) -> true.–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–ª–æ—Å–∫–æ—Å—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä. –û–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –≤–∞—à detectedWalls –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è (–∂–µ–ª—Ç–∞—è —Ä–∞–º–∫–∞).–ö–∞–¥—Ä N+1 (–£—Ç–æ—á–Ω–µ–Ω–∏–µ): ARKit –ø–æ–ª—É—á–∞–µ—Ç –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö. –û–Ω –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ —Å—Ç–µ–Ω–∞ –∏ –∫–æ—Å—è–∫ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω–æ–π –≥–ª—É–±–∏–Ω–µ. –û–Ω —É—Ç–æ—á–Ω—è–µ—Ç (Update) –≥—Ä–∞–Ω–∏—Ü—ã –ø–ª–æ—Å–∫–æ—Å—Ç–∏, —É–º–µ–Ω—å—à–∞—è –µ–µ –¥–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Ç–æ–ª—å–∫–æ –∫–æ—Å—è–∫–∞.–ö–∞–¥—Ä N+1 (–û–±—Ä–∞–±–æ—Ç–∫–∞ Updated):–°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç OnPlanesChanged —Å —ç—Ç–æ–π –∂–µ –ø–ª–æ—Å–∫–æ—Å—Ç—å—é –≤ —Å–ø–∏—Å–∫–µ args.updated.–ï–µ plane.size —Ç–µ–ø–µ—Ä—å (0.25, 2.05), —á—Ç–æ –¥–∞–µ—Ç planeArea = 0.51 –º¬≤.–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥: –í–∞—à –∫–æ–¥ –Ω–µ –∏–º–µ–µ—Ç –ª–æ–≥–∏–∫–∏ –¥–ª—è args.updated. –û–Ω –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç ShouldProcessPlane –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–ª—è —ç—Ç–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç–∏.–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–ª–æ—Å–∫–æ—Å—Ç—å –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –≤–∞—à–µ–º —Å–ª–æ–≤–∞—Ä–µ detectedWalls –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –æ–Ω–∞ –±–æ–ª—å—à–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º.–ö–∞–¥—Ä N+1 (–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ): –í–∞—à –∫–æ–¥ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤–µ–ª –∫  ‚úì –°–¢–ï–ù–ê –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞! —Ä–∞–∑–º–µ—Ä: (0.25, 2.05)) —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–≤–æ–∑–º–æ–∂–Ω–æ, –≤ Update –∏–ª–∏ –≤ —Å–∞–º–æ–º OnPlanesChanged –ø—Ä–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø–æ detectedWalls), —Å—á–∏—Ç—ã–≤–∞—è –Ω–æ–≤–æ–µ (0.51 –º¬≤) –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –¥–ª—è –ø–ª–æ—Å–∫–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å —Ä–∞–∑–º–µ—Ä–æ–º 1.1 –º¬≤.–î–∏–∞–≥–Ω–æ–∑: –ê–Ω–æ–º–∞–ª–∏—è 0.51 –º¬≤ –≤—ã–∑–≤–∞–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–ª–æ—Å–∫–æ—Å—Ç–µ–π –∏–∑ detectedWalls –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ args.updated.C. –ü—Ä–æ–±–ª–µ–º–∞ plane.size (AABB vs. –†–µ–∞–ª—å–Ω–∞—è –ü–ª–æ—â–∞–¥—å)–í–∞–∂–Ω–æ —Ç–∞–∫–∂–µ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ plane.size –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≥–∞–±–∞—Ä–∏—Ç–Ω—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ (Axis-Aligned Bounding Box, AABB), –≤—ã—Ä–æ–≤–Ω–µ–Ω–Ω—ã–π –ø–æ –æ—Å—è–º –ø–ª–æ—Å–∫–æ—Å—Ç–∏. –≠—Ç–æ –Ω–µ —Ç–æ—á–Ω–∞—è –ø–ª–æ—â–∞–¥—å –ø–æ–ª–∏–≥–æ–Ω–∞ (plane.boundary). –î–ª—è L-–æ–±—Ä–∞–∑–Ω–æ–π —Å—Ç–µ–Ω—ã AABB –±—É–¥–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ —Ä–µ–∞–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∏. –û–¥–Ω–∞–∫–æ –¥–ª—è –≤–∞—à–µ–π —Ü–µ–ª–∏ (–æ—Ç—Å–µ—á–µ–Ω–∏–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã—Ö –¥–≤–µ—Ä–µ–π –∏ —à–∫–∞—Ñ–æ–≤) plane.size.x * plane.size.y —è–≤–ª—è–µ—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–Ω–æ–π –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ –¥–µ—à–µ–≤–æ–π —ç–≤—Ä–∏—Å—Ç–∏–∫–æ–π.III. –≠–¢–ê–ü 1 (–†–ï–®–ï–ù–ò–ï "–ê–õ–¨–§–ê"): –ù–ê–î–ï–ñ–ù–ê–Ø –≠–í–†–ò–°–¢–ò–ß–ï–°–ö–ê–Ø –§–ò–õ–¨–¢–†–ê–¶–ò–Ø (–ö–û–î)–≠—Ç–æ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ. –û–Ω–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –±–∞–≥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ –≤–Ω–µ–¥—Ä—è–µ—Ç –±–æ–ª–µ–µ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—É—é —ç–≤—Ä–∏—Å—Ç–∏–∫—É –¥–ª—è –æ—Ç—Å–µ—á–µ–Ω–∏—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π.A. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ OnPlanesChanged (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–º –¶–∏–∫–ª–æ–º)–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å OnPlanesChanged –¥–ª—è —è–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö —Ç—Ä–µ—Ö —Å–ø–∏—Å–∫–æ–≤.C#// –í WallDetectionAndPainting.cs

//... (–≤–∞—à–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è)
 private float planeUpdateThrottle = 0.1f;
private float lastPlaneUpdateTime = 0f;
private Dictionary<TrackableId, ARPlane> detectedWalls = new Dictionary<TrackableId, ARPlane>();
// TODO: –î–æ–±–∞–≤—å—Ç–µ –∑–¥–µ—Å—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä –∏–ª–∏ –ª–æ–≥–∏–∫—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è GameObjects

private void OnEnable()
{
    arPlaneManager.planesChanged += OnPlanesChanged;
}

private void OnDisable()
{
    arPlaneManager.planesChanged -= OnPlanesChanged;
}

private void OnPlanesChanged(ARPlanesChangedEventArgs args)
{
    // –¢—Ä–æ—Ç—Ç–ª–∏–Ω–≥ (—É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å)
    float currentTime = Time.time;
    if (currentTime - lastPlaneUpdateTime < planeUpdateThrottle)
    {
        return;
    }
    lastPlaneUpdateTime = currentTime;

    // –û–ë–†–ê–ë–û–¢–ö–ê –î–û–ë–ê–í–õ–ï–ù–ù–´–• –ü–õ–û–°–ö–û–°–¢–ï–ô (args.added)
    foreach (var newPlane in args.added)
    {
        ProcessAddedPlane(newPlane);
    }

    // –û–ë–†–ê–ë–û–¢–ö–ê –û–ë–ù–û–í–õ–ï–ù–ù–´–• –ü–õ–û–°–ö–û–°–¢–ï–ô (args.updated)
    foreach (var updatedPlane in args.updated)
    {
        ProcessUpdatedPlane(updatedPlane);
    }

    // –û–ë–†–ê–ë–û–¢–ö–ê –£–î–ê–õ–ï–ù–ù–´–• –ü–õ–û–°–ö–û–°–¢–ï–ô (args.removed)
    foreach (var removedPlane in args.removed)
    {
        ProcessRemovedPlane(removedPlane);
    }
}

private void ProcessAddedPlane(ARPlane plane)
{
    if (ShouldProcessPlane(plane))
    {
        if (!detectedWalls.ContainsKey(plane.trackableId))
        {
            detectedWalls.Add(plane.trackableId, plane);
            Debug.Log($" ‚úì –ù–û–í–ê–Ø –°–¢–ï–ù–ê –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞! ID: {plane.trackableId}, –†–∞–∑–º–µ—Ä: {plane.size}");
            // TODO: –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å/—Å–æ–∑–¥–∞—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä –¥–ª—è —ç—Ç–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç–∏
            // VisualizeWall(plane);
        }
    }
}

private void ProcessUpdatedPlane(ARPlane plane)
{
    bool isCurrentlyWall = detectedWalls.ContainsKey(plane.trackableId);
    bool shouldBeWall = ShouldProcessPlane(plane);

    if (shouldBeWall)
    {
        if (!isCurrentlyWall)
        {
            // –ü–ª–æ—Å–∫–æ—Å—Ç—å "–≤—ã—Ä–æ—Å–ª–∞" –∏ –¢–ï–ü–ï–†–¨ —Å—Ç–∞–ª–∞ —Å—Ç–µ–Ω–æ–π
            detectedWalls.Add(plane.trackableId, plane);
            Debug.Log($" ‚úì –°–¢–ï–ù–ê –û–ë–ù–û–í–ò–õ–ê–°–¨ (—Å—Ç–∞–ª–∞ –≤–∞–ª–∏–¥–Ω–æ–π)! ID: {plane.trackableId}, –†–∞–∑–º–µ—Ä: {plane.size}");
            // TODO: –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å/—Å–æ–∑–¥–∞—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä
            // VisualizeWall(plane);
        }
        else
        {
            // –ü–ª–æ—Å–∫–æ—Å—Ç—å –≤—Å–µ –µ—â–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–µ–Ω–æ–π, –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å –≥—Ä–∞–Ω–∏—Ü—ã
            // TODO: –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä
            // UpdateWallVisualization(plane);
        }
    }
    else
    {
        if (isCurrentlyWall)
        {
            // –≠–¢–û –í–ê–® –ë–ê–ì 0.51–º¬≤!
            // –ü–ª–æ—Å–∫–æ—Å—Ç—å "—É–º–µ–Ω—å—à–∏–ª–∞—Å—å" –∏ –ë–û–õ–¨–®–ï –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–µ–Ω–æ–π
            detectedWalls.Remove(plane.trackableId);
            Debug.LogWarning($" ‚úó –°–¢–ï–ù–ê –£–î–ê–õ–ï–ù–ê (—Å—Ç–∞–ª–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π)! ID: {plane.trackableId}, –†–∞–∑–º–µ—Ä: {plane.size}");
            // TODO: –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä
            // HideWall(plane.trackableId);
        }
    }
}

private void ProcessRemovedPlane(ARPlane plane)
{
    if (detectedWalls.ContainsKey(plane.trackableId))
    {
        detectedWalls.Remove(plane.trackableId);
        Debug.Log($" ‚úó –°–¢–ï–ù–ê –£–î–ê–õ–ï–ù–ê (ARKit)! ID: {plane.trackableId}");
        // TODO: –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä
        // HideWall(plane.trackableId);
    }
}
B. –£—Å–∏–ª–µ–Ω–∏–µ ShouldProcessPlane (–ù–æ–≤—ã–µ –§–∏–ª—å—Ç—Ä—ã)–¢–µ–ø–µ—Ä—å –º—ã –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –≤–∞—à ShouldProcessPlane, –¥–æ–±–∞–≤–ª—è—è –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –≥–µ–æ–º–µ—Ç—Ä–∏–∏.–ù–æ–≤—ã–µ –§–∏–ª—å—Ç—Ä—ã:–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –°—Ç–æ—Ä–æ–Ω (Aspect Ratio): –°–∞–º—ã–π –º–æ—â–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ—Ç–∏–≤ –∫–æ—Å—è–∫–æ–≤ (Image 4) –∏ –¥–≤–µ—Ä–µ–π (Image 1, 2). –ö–æ—Å—è–∫ (0.25x2.05) –∏–º–µ–µ—Ç AR ~0.12. –î–≤–µ—Ä—å (0.8x2.0) –∏–º–µ–µ—Ç AR ~0.4. –°—Ç–µ–Ω–∞ (3.0x2.5) –∏–º–µ–µ—Ç AR ~1.2.–í—ã—Å–æ—Ç–∞ –¶–µ–Ω—Ç—Ä–∞ (Center Height): –û—Ç—Å–µ–∫–∞–µ—Ç –Ω–∏–∑–∫—É—é –º–µ–±–µ–ª—å. –¶–µ–Ω—Ç—Ä —Å—Ç–µ–Ω—ã (–æ—Ç 0 –¥–æ 2.5 –º) –±—É–¥–µ—Ç ~1.25 –º. –¶–µ–Ω—Ç—Ä –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –¥–∏–≤–∞–Ω–∞ (–æ—Ç 0.3 –¥–æ 0.9 –º) –±—É–¥–µ—Ç ~0.6 –º.C. –¢–∞–±–ª–∏—Ü–∞ 1: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –§–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–≠—Ç–∞–ø 1)–ó–Ω–∞—á–µ–Ω–∏—è –ø–æ–¥–æ–±—Ä–∞–Ω—ã –¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ (–æ—Ç—Å–µ—á–µ–Ω–∏–µ –¥–≤–µ—Ä–µ–π) –∑–∞ —Å—á–µ—Ç –ø–æ–ª–Ω–æ—Ç—ã (–æ—Ç—Å–µ—á–µ–Ω–∏–µ –º–∞–ª—ã—Ö —Å—Ç–µ–Ω), —Å–æ–≥–ª–∞—Å–Ω–æ –≤–∞—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º.–ü–∞—Ä–∞–º–µ—Ç—Ä–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –ó–Ω–∞—á–µ–Ω–∏–µ–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µminWallArea2.5f–û—Ç—Å–µ–∫–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–≤–µ—Ä–∏ (~1.6 –º¬≤) –∏ —à–∫–∞—Ñ—ã (~2.0 –º¬≤). –í–∞—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ 1.0 –º¬≤ –±—ã–ª–æ —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–º.minWallHeight1.5f–û—Ç—Å–µ–∫–∞–µ—Ç –Ω–∏–∑–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã (–º–µ–±–µ–ª—å). –î–≤–µ—Ä–∏ (~2.0–º) –ø—Ä–æ–π–¥—É—Ç, –Ω–æ –±—É–¥—É—Ç –æ—Ç—Å–µ—á–µ–Ω—ã –ø–æ minWallArea.minAspectRatio0.3f–û—Ç—Å–µ–∫–∞–µ—Ç —É–∑–∫–∏–µ –∫–æ—Å—è–∫–∏ (AR ~0.12), –Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –¥–≤–µ—Ä–∏ (AR ~0.4) –∏ —É–∑–∫–∏–µ —Å—Ç–µ–Ω—ã (AR ~0.4).maxAspectRatio5.0f–û—Ç—Å–µ–∫–∞–µ—Ç –¥–ª–∏–Ω–Ω—ã–µ, –Ω–æ –Ω–∏–∑–∫–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≥–µ–æ–º–µ—Ç—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–ª–∏–Ω—Ç—É—Å).minCenterHeightY0.7f–û—Ç—Å–µ–∫–∞–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –¥–∏–≤–∞–Ω–æ–≤/—Å—Ç–æ–ª–æ–≤ (Image 6), —á–µ–π —Ü–µ–Ω—Ç—Ä < 0.7–º –æ—Ç –ø–æ–ª–∞.D. –ü–æ–ª–Ω—ã–π –ö–æ–¥ –¥–ª—è WallDetectionAndPainting.cs (–≠—Ç–∞–ø 1)–í–æ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π ShouldProcessPlane –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è. (–í—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ —Ç–æ—Ç –∂–µ –∫–ª–∞—Å—Å, —á—Ç–æ –∏ –∫–æ–¥ –∏–∑ III.A).C#//... (–≤ WallDetectionAndPainting.cs, –¥–æ–±–∞–≤—å—Ç–µ —ç—Ç–∏ –ø–æ–ª—è)

[Header("–≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è (–≠—Ç–∞–ø 1)")]


private float minWallArea = 2.5f;



private float minWallHeight = 1.5f;



private float minAspectRatio = 0.3f;



private float maxAspectRatio = 5.0f;



private float minCenterHeightY = 0.7f;

//... (–≤—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ OnEnable, OnDisable, OnPlanesChanged, Process... –∏–∑ III.A)

/// <summary>
/// –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–ª–æ—Å–∫–æ—Å—Ç—å ARPlane "—Å—Ç–µ–Ω–æ–π".
/// </summary>
private bool ShouldProcessPlane(ARPlane plane)
{
    // –§–∏–ª—å—Ç—Ä 1: –¢–æ–ª—å–∫–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ø–ª–æ—Å–∫–æ—Å—Ç–∏
    if (plane.alignment!= PlaneAlignment.Vertical)
    {
        // –≠—Ç–æ—Ç –ª–æ–≥ –±—É–¥–µ—Ç —Å–ø–∞–º–∏—Ç—å, –º–æ–∂–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
        // Debug.Log($" –ò–≥–Ω–æ—Ä: –ù–µ–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ø–ª–æ—Å–∫–æ—Å—Ç—å (alignment: {plane.alignment})");
        return false;
    }

    Vector2 planeSize = plane.size;
    float planeArea = planeSize.x * planeSize.y;

    // –§–∏–ª—å—Ç—Ä 2: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å (–ö–õ–Æ–ß–ï–í–û–ô –§–ò–õ–¨–¢–† –î–õ–Ø –î–í–ï–†–ï–ô)
    if (planeArea < minWallArea)
    {
        Debug.LogWarning($" –ò–≥–Ω–æ—Ä: –ü–ª–æ—Å–∫–æ—Å—Ç—å {plane.trackableId} —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∞—è (–ü–ª–æ—â–∞–¥—å: {planeArea:F2}–º¬≤ < {minWallArea}–º¬≤)");
        return false;
    }

    // –§–∏–ª—å—Ç—Ä 3: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞
    if (planeSize.y < minWallHeight)
    {
        Debug.LogWarning($" –ò–≥–Ω–æ—Ä: –ü–ª–æ—Å–∫–æ—Å—Ç—å {plane.trackableId} —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∞—è (–í—ã—Å–æ—Ç–∞: {planeSize.y:F2}–º < {minWallHeight}–º)");
        return false;
    }

    // –§–∏–ª—å—Ç—Ä 4: –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω (–ö–õ–Æ–ß–ï–í–û–ô –§–ò–õ–¨–¢–† –î–õ–Ø –ö–û–°–Ø–ö–û–í)
    float aspectRatio = planeSize.x / planeSize.y;
    if (aspectRatio < minAspectRatio)
    {
        Debug.LogWarning($" –ò–≥–Ω–æ—Ä: –ü–ª–æ—Å–∫–æ—Å—Ç—å {plane.trackableId} —Å–ª–∏—à–∫–æ–º —É–∑–∫–∞—è (Aspect: {aspectRatio:F2} < {minAspectRatio})");
        return false;
    }

    if (aspectRatio > maxAspectRatio)
    {
        Debug.LogWarning($" –ò–≥–Ω–æ—Ä: –ü–ª–æ—Å–∫–æ—Å—Ç—å {plane.trackableId} —Å–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∞—è (Aspect: {aspectRatio:F2} > {maxAspectRatio})");
        return false;
    }

    // –§–∏–ª—å—Ç—Ä 5: –í—ã—Å–æ—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞ (–ö–õ–Æ–ß–ï–í–û–ô –§–ò–õ–¨–¢–† –î–õ–Ø –ú–ï–ë–ï–õ–ò)
    float centerHeight = plane.transform.position.y;
    if (centerHeight < minCenterHeightY)
    {
        Debug.LogWarning($" –ò–≥–Ω–æ—Ä: –ü–ª–æ—Å–∫–æ—Å—Ç—å {plane.trackableId} –∏–º–µ–µ—Ç —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–π —Ü–µ–Ω—Ç—Ä (Center Y: {centerHeight:F2}–º < {minCenterHeightY}–º)");
        return false;
    }
    
    // –ï—Å–ª–∏ –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø—Ä–æ–π–¥–µ–Ω—ã - —ç—Ç–æ —Å—Ç–µ–Ω–∞
    return true;
}
IV. –≠–¢–ê–ü 2 (–†–ï–®–ï–ù–ò–ï "–î–ï–õ–¨–¢–ê"): –í–ê–õ–ò–î–ê–¶–ò–Ø –ü–û –ì–õ–£–ë–ò–ù–ï (–ö–û–î)–≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ "—Å–∫—Ä—ã—Ç—ã–π –∫–æ–∑—ã—Ä—å", –∫–æ—Ç–æ—Ä–æ–µ –≤—ã –Ω–µ —É—á–ª–∏. –í–∞—à iPhone 13 (A15) –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ Depth API —á–µ—Ä–µ–∑ ARKit, –¥–∞–∂–µ –±–µ–∑ LiDAR. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –¥–ª—è –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏.A. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è: "–ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π" –ê–Ω–∞–ª–∏–∑ –±–µ–∑ ML–õ–æ–≥–∏–∫–∞ –ø—Ä–æ—Å—Ç–∞: –Ω–∞—Å—Ç–æ—è—â–∞—è —Å—Ç–µ–Ω–∞ (–≤–∞—à True Positive) –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏ –ø–ª–æ—Å–∫–∞—è. –ü–æ—á—Ç–∏ –≤—Å–µ –≤–∞—à–∏ –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è ‚Äî –Ω–µ—Ç:–°—Ç–µ–Ω–∞ + –ú–µ–±–µ–ª—å (Image 6): –ù–µ –ø–ª–æ—Å–∫–∞—è. –ì–ª—É–±–∏–Ω–∞ –∏–º–µ–µ—Ç –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è (—Å—Ç–µ–Ω–∞ –Ω–∞ 3–º, –¥–∏–≤–∞–Ω –Ω–∞ 2.5–º).–î–≤–µ—Ä–Ω–æ–π –ö–æ—Å—è–∫ (Image 4): –ù–µ –ø–ª–æ—Å–∫–∏–π. –ì–ª—É–±–∏–Ω–∞ –∏–º–µ–µ—Ç –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è (—Å—Ç–µ–Ω–∞ –Ω–∞ 3–º, –∫–æ—Å—è–∫ –Ω–∞ 2.9–º).–£—Ç–æ–ø–ª–µ–Ω–Ω–∞—è –î–≤–µ—Ä—å (Image 2): –ù–µ –ø–ª–æ—Å–∫–∞—è.–ú—ã –º–æ–∂–µ–º –∏–∑–º–µ—Ä–∏—Ç—å —ç—Ç—É "–ø–ª–æ—Å–∫–æ—Å—Ç–Ω–æ—Å—Ç—å" –ø—É—Ç–µ–º —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (Standard Deviation) –∏–ª–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ (Variance) –∑–Ω–∞—á–µ–Ω–∏–π –≥–ª—É–±–∏–Ω—ã –≤–Ω—É—Ç—Ä–∏ 2D-–≥—Ä–∞–Ω–∏—Ü –ø–ª–æ—Å–∫–æ—Å—Ç–∏.if (depthVariance > THRESHOLD_FURNITURE) -> –≠—Ç–æ –Ω–µ —Å—Ç–µ–Ω–∞.–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –Ω–µ –æ—Ç—Å–µ—á–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ –ø–ª–æ—Å–∫–∏–µ –∫–∞—Ä—Ç–∏–Ω—ã –∏–ª–∏ –¥–≤–µ—Ä–∏, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –≤—Ä–æ–≤–µ–Ω—å —Å–æ —Å—Ç–µ–Ω–æ–π. –ù–æ –æ–Ω –æ—Ç—Å–µ—á–µ—Ç –ø–æ—á—Ç–∏ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã —Å 3D-—Ä–µ–ª—å–µ—Ñ–æ–º, –≤–∫–ª—é—á–∞—è –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É —Å –º–µ–±–µ–ª—å—é (Image 6).B. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏–í–∫–ª—é—á–∏—Ç—å Depth: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ XROrigin (–∏–ª–∏ –Ω–∞ Main Camera) –µ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç AROcclusionManager. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Environment Depth Mode –≤ Medium –∏–ª–∏ Best.24–ü—Ä–æ–±–ª–µ–º–∞ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: –ß—Ç–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç—É—Ä—ã –≥–ª—É–±–∏–Ω—ã (_occlusionManager.environmentDepthTexture 11) –Ω–∞ CPU (GetPixel) –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏ –º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–∞—à –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫.–†–µ—à–µ–Ω–∏–µ: Compute Shader. –ú—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ—Ç –∞–Ω–∞–ª–∏–∑ –Ω–∞ GPU. –ú—ã –Ω–∞–ø–∏—à–µ–º Compute Shader DepthValidator.compute, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑—å–º–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –ø–ª–æ—Å–∫–æ—Å—Ç–∏, –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç—ã—Å—è—á–∏ –ø–∏–∫—Å–µ–ª–µ–π –≥–ª—É–±–∏–Ω—ã –∏ –≤–µ—Ä–Ω–µ—Ç 3 —á–∏—Å–ª–∞: count, sum, sumOfSquares.C. –ê–ª–≥–æ—Ä–∏—Ç–º –í–∞–ª–∏–¥–∞—Ü–∏–∏ (Compute Shader)C# (CPU): –í ShouldProcessPlane (–ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≠—Ç–∞–ø–∞ 1):a.  –ü–æ–ª—É—á–∏—Ç—å ARPlane.boundary (—Å–ø–∏—Å–æ–∫ Vector3 –≤ world space).b.  –°–ø—Ä–æ–µ—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –Ω–∞ —ç–∫—Ä–∞–Ω: Camera.main.WorldToScreenPoint() -> Vector2 screenPoints.c.  –ü–µ—Ä–µ–¥–∞—Ç—å environmentDepthTexture, screenPoints (–∫–∞–∫ ComputeBuffer) –∏ UV-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ Compute Shader.d.  –ó–∞–ø—É—Å—Ç–∏—Ç—å (Dispatch) Compute Shader.e.  –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–±—É—Ñ–µ—Ä –∏–∑ 3-—Ö float).Compute Shader (GPU):a.  –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç—ã—Å—è—á–∏ –ø–æ—Ç–æ–∫–æ–≤.b.  –ö–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ —Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–∏–∫—Å–µ–ª—å –≥–ª—É–±–∏–Ω—ã (depthTexture.SampleLevel).c.  –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø–∏–∫—Å–µ–ª—å –≤–Ω—É—Ç—Ä–∏ 2D-–ø–æ–ª–∏–≥–æ–Ω–∞ (–∞–ª–≥–æ—Ä–∏—Ç–º Point-in-Polygon).d.  –ï—Å–ª–∏ –¥–∞, –∞—Ç–æ–º–∞—Ä–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å depth, depth * depth –∏ 1.0 –≤ –≤—ã—Ö–æ–¥–Ω–æ–π –±—É—Ñ–µ—Ä.C# (CPU):a.  –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–∏—Å–ø–µ—Ä—Å–∏—é: Variance = (SumSq / N) - (Sum / N)^2.b.  if (Variance > DEPTH_VARIANCE_THRESHOLD) return false;.D. –ö–æ–¥ (C# DepthValidator.cs –∏ DepthValidator.compute)–≠—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è.1. –°–æ–∑–¥–∞–π—Ç–µ DepthValidator.compute (HLSL):–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª Assets/Resources/DepthValidator.compute.High-level shader language#pragma kernel CSMain

// –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
Texture2D<float> _DepthTexture; // –¢–µ–∫—Å—Ç—É—Ä–∞ –≥–ª—É–±–∏–Ω—ã –æ—Ç AROcclusionManager
StructuredBuffer<float2> _BoundaryScreenPoints; // –ì—Ä–∞–Ω–∏—Ü—ã –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
int _PointCount; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –≤ _BoundaryScreenPoints
float4x4 _DisplayTransform; // –ú–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ UV

// –í—ã—Ö–æ–¥–Ω–æ–π –±—É—Ñ–µ—Ä (N, Sum, SumSq)
RWStructuredBuffer<float> _ResultBuffer; 

// –ê–ª–≥–æ—Ä–∏—Ç–º Point-in-Polygon (Ray Casting)
bool IsPointInPolygon(float2 p, StructuredBuffer<float2> poly, int count)
{
    bool c = false;
    for (int i = 0, j = count - 1; i < count; j = i++)
    {
        if (((poly[i].y > p.y)!= (poly[j].y > p.y)) &&
            (p.x < (poly[j].x - poly[i].x) * (p.y - poly[i].y) / (poly[j].y - poly[i].y) + poly[i].x))
        {
            c =!c;
        }
    }
    return c;
}

[numthreads(32, 32, 1)]
void CSMain(uint3 id : SV_DispatchThreadID)
{
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –ø–æ—Ç–æ–∫)
    if (id.x == 0 && id.y == 0)
    {
        _ResultBuffer = 0.0; // N
        _ResultBuffer = 0.0; // Sum
        _ResultBuffer = 0.0; // SumSq
    }
    
    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ _ResultBuffer –æ–±–Ω—É–ª–µ–Ω
    GroupMemoryBarrierWithGroupSync();

    // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ—Ç–æ–∫–∞ = –ø–∏–∫—Å–µ–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
    float2 pixelCoord = float2(id.x, id.y);
    
    // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø–∏–∫—Å–µ–ª—å –í–ù–£–¢–†–ò 2D-–ø–æ–ª–∏–≥–æ–Ω–∞
    if (!IsPointInPolygon(pixelCoord, _BoundaryScreenPoints, _PointCount))
    {
        return; // –ü–æ—Ç–æ–∫ –≤–Ω–µ –ø–æ–ª–∏–≥–æ–Ω–∞, –≤—ã—Ö–æ–¥
    }

    // 2. –ü–æ–ª—É—á–∞–µ–º UV –∏–∑ –ø–∏–∫—Å–µ–ª—å–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
    // TODO: –í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å _ScreenParams (width, height)
    // float2 uv = pixelCoord / _ScreenParams.xy; 
    
    // –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ _DepthTexture —Ç—Ä–µ–±—É–µ—Ç
    // –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏–∑ —ç–∫—Ä–∞–Ω–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ UV —Ç–µ–∫—Å—Ç—É—Ä—ã –≥–ª—É–±–∏–Ω—ã.
    // –¢–µ–∫—Å—Ç—É—Ä–∞ –≥–ª—É–±–∏–Ω—ã –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ —Ç–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞, —á—Ç–æ –∏ —ç–∫—Ä–∞–Ω.
    // –≠—Ç–æ –£–ü–†–û–©–ï–ù–ù–ê–Ø –≤–µ—Ä—Å–∏—è. –î–ª—è production –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è
    // _occlusionManager.GetEnvironmentDepthDisplayMatrix()
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Ç—Ä–∏—Ü—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∏—Å–ø–ª–µ—è
    float2 uv = mul(_DisplayTransform, float4(pixelCoord.x / _ScreenWidth, pixelCoord.y / _ScreenHeight, 0, 1)).xy;
    
    // 3. –°—ç–º–ø–ª–∏—Ä—É–µ–º –≥–ª—É–±–∏–Ω—É
    float depth = _DepthTexture.SampleLevel(sampler_DepthTexture, uv, 0).r;

    // 4. –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–æ–±—ã—á–Ω–æ 0 –∏–ª–∏ 1)
    if (depth <= 0.0 |

| depth >= 1.0)
    {
        return;
    }

    // 5. –ê—Ç–æ–º–∞—Ä–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    InterlockedAdd(_ResultBuffer, 1.0);       // N
    InterlockedAdd(_ResultBuffer, depth);     // Sum
    InterlockedAdd(_ResultBuffer, depth * depth); // SumSq
}
2. C# –ö–ª–∞—Å—Å-–≤–∞–ª–∏–¥–∞—Ç–æ—Ä DepthValidator.cs:(–≠—Ç–æ—Ç –∫–ª–∞—Å—Å –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å Compute Shader)C#using UnityEngine;
using UnityEngine.XR.ARFoundation;
using System.Collections.Generic;
using System.Threading.Tasks;

public class DepthValidator : MonoBehaviour
{
    private AROcclusionManager occlusionManager;
    private ComputeShader depthComputeShader;
    private Camera arCamera;
    
    // –ü–æ—Ä–æ–≥ –¥–∏—Å–ø–µ—Ä—Å–∏–∏. –ü–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ. 
    // –ù–∞—á–Ω–∏—Ç–µ —Å 0.001. –ï—Å–ª–∏ 0.001 - –∑–Ω–∞—á–∏—Ç, std dev ~ 0.03–º (3 —Å–º).
    private float depthVarianceThreshold = 0.001f; 

    private ComputeBuffer pointsBuffer;
    private ComputeBuffer resultBuffer;
    private float resultData;

    private int kernelHandle;

    void Start()
    {
        if (depthComputeShader == null)
        {
            Debug.LogError("Compute Shader –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω!");
            this.enabled = false;
            return;
        }
        kernelHandle = depthComputeShader.FindKernel("CSMain");
        
        // –ë—É—Ñ–µ—Ä –¥–ª—è 3—Ö float: (N, Sum, SumSq)
        resultBuffer = new ComputeBuffer(3, sizeof(float));
        resultData = new float;
    }
    
    // –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ ShouldProcessPlane
    public async Task<bool> IsPlaneGeometricallyFlat(ARPlane plane)
    {
        if (occlusionManager == null ||!occlusionManager.enabled |

| 
            occlusionManager.environmentDepthTexture == null)
        {
            Debug.LogWarning("Depth API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É.");
            return true; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É, –µ—Å–ª–∏ Depth API –≤—ã–∫–ª—é—á–µ–Ω–æ
        }

        List<Vector2> screenPoints = new List<Vector2>();
        foreach (var worldPos in plane.boundary)
        {
            screenPoints.Add(arCamera.WorldToScreenPoint(worldPos));
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –±—É—Ñ–µ—Ä—ã
        if (pointsBuffer == null |

| pointsBuffer.count < screenPoints.Count)
        {
            pointsBuffer?.Release();
            pointsBuffer = new ComputeBuffer(screenPoints.Count, sizeof(float) * 2);
        }
        pointsBuffer.SetData(screenPoints);
        resultBuffer.SetData(new float); // –°–±—Ä–æ—Å

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Compute Shader
        depthComputeShader.SetTexture(kernelHandle, "_DepthTexture", occlusionManager.environmentDepthTexture);
        depthComputeShader.SetBuffer(kernelHandle, "_BoundaryScreenPoints", pointsBuffer);
        depthComputeShader.SetInt("_PointCount", screenPoints.Count);
        depthComputeShader.SetBuffer(kernelHandle, "_ResultBuffer", resultBuffer);
        depthComputeShader.SetMatrix("_DisplayTransform", occlusionManager.environmentDepthDisplayMatrix);
        depthComputeShader.SetFloat("_ScreenWidth", Screen.width);
        depthComputeShader.SetFloat("_ScreenHeight", Screen.height);

        // –ó–∞–ø—É—Å–∫
        // –ú—ã –¥–æ–ª–∂–Ω—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ—Ç–æ–∫–æ–≤, —á—Ç–æ–±—ã –ø–æ–∫—Ä—ã—Ç—å AABB –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
        // –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ AABB, –∑–¥–µ—Å—å —É–ø—Ä–æ—â–µ–Ω–æ
        int threadGroupsX = Mathf.CeilToInt(Screen.width / 32.0f);
        int threadGroupsY = Mathf.CeilToInt(Screen.height / 32.0f);
        
        depthComputeShader.Dispatch(kernelHandle, threadGroupsX, threadGroupsY, 1);

        // –ñ–¥–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —á–µ—Ä–µ–∑ AsyncGPUReadback
        await Task.Yield(); // –î–∞–µ–º GPU –∫–∞–¥—Ä –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
        
        resultBuffer.GetData(resultData);

        float N = resultData;
        float sum = resultData;
        float sumSq = resultData;

        if (N < 100) // –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        {
            Debug.LogWarning("Depth Validation: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–µ–∫ (<100)");
            return true; // –°—á–∏—Ç–∞–µ–º, —á—Ç–æ –≤—Å–µ –≤ –ø–æ—Ä—è–¥–∫–µ
        }

        // –†–∞—Å—á–µ—Ç –¥–∏—Å–ø–µ—Ä—Å–∏–∏: Var(X) = E[X^2] - (E[X])^2
        float variance = (sumSq / N) - Mathf.Pow(sum / N, 2);
        
        if (variance > depthVarianceThreshold)
        {
            Debug.LogWarning($" –ò–≥–Ω–æ—Ä: –ü–ª–æ—Å–∫–æ—Å—Ç—å {plane.trackableId} –ù–ï –ø–ª–æ—Å–∫–∞—è (–î–∏—Å–ø–µ—Ä—Å–∏—è: {variance} > {depthVarianceThreshold})");
            return false;
        }

        Debug.Log($" ‚úì –ü–ª–æ—Å–∫–æ—Å—Ç—å {plane.trackableId} –ø–ª–æ—Å–∫–∞—è (–î–∏—Å–ø–µ—Ä—Å–∏—è: {variance})");
        return true;
    }

    void OnDestroy()
    {
        pointsBuffer?.Release();
        resultBuffer?.Release();
    }
}
3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ WallDetectionAndPainting.cs:–í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞—Ç—å ShouldProcessPlane –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º (—á—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –¥–ª—è –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è). –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ, ProcessAddedPlane –∏ ProcessUpdatedPlane –¥–æ–ª–∂–Ω—ã —Å—Ç–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ (async void) –∏ –≤—ã–∑—ã–≤–∞—Ç—å await depthValidator.IsPlaneGeometricallyFlat(plane).V. –≠–¢–ê–ü 3 (–†–ï–®–ï–ù–ò–ï "–ë–†–ê–í–û"): –°–ï–ú–ê–ù–¢–ò–ß–ï–°–ö–ê–Ø –°–ï–ì–ú–ï–ù–¢–ê–¶–ò–Ø (ML)–≠—Ç–æ –≤–∞—à "–∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç" (–†–µ—à–µ–Ω–∏–µ B) –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è 5% —Å–ª—É—á–∞–µ–≤ (–ø–ª–æ—Å–∫–∏–µ –∫–∞—Ä—Ç–∏–Ω—ã, –¥–≤–µ—Ä–∏ –≤—Ä–æ–≤–µ–Ω—å).A. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è: "–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ" –ó—Ä–µ–Ω–∏–µ–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º ML-–º–æ–¥–µ–ª—å –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è –∫–∞–¥—Ä–∞.14B. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ú–æ–¥–µ–ª–µ–π (SegFormer vs. DeepLabV3+)–í–∞—à –≤—ã–±–æ—Ä SegFormer-B0 (—Å–∞–º–∞—è –ª–µ–≥–∫–∞—è –≤–µ—Ä—Å–∏—è) ‚Äî –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤–µ—Ä–Ω—ã–π.2 –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è 2 –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ SegFormer-B0 –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ª—É—á—à—É—é –∏–ª–∏ —Å—Ä–∞–≤–Ω–∏–º—É—é —Ç–æ—á–Ω–æ—Å—Ç—å —Å DeepLabV3+ 13, –±—É–¥—É—á–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ (–¥–æ 2x-3x) –±—ã—Å—Ç—Ä–µ–µ –∏ –ª–µ–≥—á–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö GPU. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è 30+ FPS.C. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –î–∞–Ω–Ω—ã—Ö (ADE20K)–í–∞–º –Ω–µ –Ω—É–∂–Ω–æ –æ–±—É—á–∞—Ç—å —Å–≤–æ—é –º–æ–¥–µ–ª—å. –ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö ADE20K 14 —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–ª–∞—Å—Å—ã: wall, door, cabinet, furniture-other, painting.5–†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—É—é, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, nvidia/segformer-b0-finetuned-ade-512-512  —Å Hugging Face.D. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–£–ª—É—á—à–µ–Ω–Ω–∞—è)–í–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ CanPaintAtScreenPosition (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Ä–∏—Å–æ–≤–∞–Ω–∏–∏) ‚Äî —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ–µ. –û–Ω–æ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è 100+ —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –ø–∞–ª—å—Ü–∞.–£–ª—É—á—à–µ–Ω–Ω—ã–π –ê–ª–≥–æ—Ä–∏—Ç–º: –û–¥–Ω–æ–∫—Ä–∞—Ç–Ω–∞—è –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –í–∞–ª–∏–¥–∞—Ü–∏—è–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º ML –¥–ª—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–ª–æ—Å–∫–æ—Å—Ç–∏, –∞ –Ω–µ –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è.ARPlane –ø—Ä–æ—Ö–æ–¥–∏—Ç –≠—Ç–∞–ø 1 (–≠–≤—Ä–∏—Å—Ç–∏–∫–∞).ARPlane (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ) –ø—Ä–æ—Ö–æ–¥–∏—Ç –≠—Ç–∞–ø 2 (–ì–ª—É–±–∏–Ω–∞).–¢–æ–ª—å–∫–æ —Ç–µ–ø–µ—Ä—å –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º –¥–æ—Ä–æ–≥—É—é ML-–≤–∞–ª–∏–¥–∞—Ü–∏—é (–æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç—å):a.  –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∞—Å–∫—É —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (–∫–æ—Ç–æ—Ä–∞—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ —Å —Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥–æ–º, 5 FPS).b.  –°–ø—Ä–æ–µ—Ü–∏—Ä–æ–≤–∞—Ç—å plane.boundary –Ω–∞ —ç–∫—Ä–∞–Ω (–∫–∞–∫ –≤ –≠—Ç–∞–ø–µ 2).c.  –°—ç–º–ø–ª–∏—Ä–æ–≤–∞—Ç—å N —Ç–æ—á–µ–∫ –≤–Ω—É—Ç—Ä–∏ 2D-–ø–æ–ª–∏–≥–æ–Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –Ω–∞ –º–∞—Å–∫–µ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.d.  –°–æ–±—Ä–∞—Ç—å –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É –∫–ª–∞—Å—Å–æ–≤: {'wall': 0, 'door': 0, 'furniture': 0}.e.  –ö—Ä–∏—Ç–µ—Ä–∏–π: if (histogram['wall'] / N < 0.8) -> return false; (–ï—Å–ª–∏ <80% –ø–∏–∫—Å–µ–ª–µ–π —ç—Ç–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è "—Å—Ç–µ–Ω–æ–π", –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ–º –µ–µ).–¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ ARPlane –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ detectedWalls –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è. –í–∞—à CanPaintAtScreenPosition –º–æ–∂–µ—Ç —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å true, —Ç–∞–∫ –∫–∞–∫ –º—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –ø–ª–æ—Å–∫–æ—Å—Ç—å ‚Äî —ç—Ç–æ —Å—Ç–µ–Ω–∞.–≠—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –≤—Å—é —Ç—è–∂–µ–ª—É—é —Ä–∞–±–æ—Ç—É —Å –º–æ–º–µ–Ω—Ç–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è (real-time) –Ω–∞ –º–æ–º–µ–Ω—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è (non-real-time).VI. –î–ï–¢–ê–õ–¨–ù–´–ô –ü–õ–ê–ù –í–ù–ï–î–†–ï–ù–ò–Ø ML (–≠–¢–ê–ü 3)A. –¢–∞–±–ª–∏—Ü–∞ 2: –î–µ—Ç–∞–ª—å–Ω—ã–π –ü–ª–∞–Ω-–≥—Ä–∞—Ñ–∏–∫ –í–Ω–µ–¥—Ä–µ–Ω–∏—è ML (3 –ù–µ–¥–µ–ª–∏)–ù–µ–¥–µ–ª—è–ó–∞–¥–∞—á–∞–ö–ª—é—á–µ–≤—ã–µ –î–µ–π—Å—Ç–≤–∏—è (iOS: CoreML)–ö–ª—é—á–µ–≤—ã–µ –î–µ–π—Å—Ç–≤–∏—è (Android: TFLite)–ò—Å—Ç–æ—á–Ω–∏–∫–∏–ù–µ–¥–µ–ª—è 1: –ú–æ–¥–µ–ª—å –∏ –ù–∞—Ç–∏–≤–Ω—ã–π –ú–æ—Å—Ç1.1 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ú–æ–¥–µ–ª–∏pip install transformers coremltools. –ó–∞–≥—Ä—É–∑–∏—Ç—å Segformer-B0. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ SegFormer_B0.mlmodel.16pip install tensorflow. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ segformer_b0_quant.tflite (—Å FP16/INT8 –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–µ–π).1831.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ú–æ—Å—Ç–∞ (iOS)–°–æ–∑–¥–∞—Ç—å UnitySegmentationBridge.mm. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å VNCoreMLRequest –¥–ª—è SegFormer_B0.mlmodel. –ù–∞–ø–∏—Å–∞—Ç—å C-—Ñ—É–Ω–∫—Ü–∏–∏ _InitSegmentation –∏ _RunSegmentation.27(–ù/–î)161.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ú–æ—Å—Ç–∞ (Android)–°–æ–∑–¥–∞—Ç—å SegmentationPlugin.java. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å TFLite Interpreter.19 –ù–∞–ø–∏—Å–∞—Ç—å JNI-–º–æ—Å—Ç jni-bridge.cpp.19–ù–µ–¥–µ–ª—è 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Unity2.1 C# –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–í MLSegmentationManager.cs –¥–æ–±–∞–≤–∏—Ç—å (iOS) [16] –∏ (Android).162.2 –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ó–∞–ø—Ä–æ—Å–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Update() —Å —Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥–æ–º (5 FPS). –ó–∞–ø—É—Å–∫–∞—Ç—å _RunSegmentation –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ (Task.Run), —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å UI-–ø–æ—Ç–æ–∫.292.3 –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–ü–æ–ª—É—á–∏—Ç—å ARCamera —Ç–µ–∫—Å—Ç—É—Ä—É (—á–µ—Ä–µ–∑ AROcclusionManager). –ù–∞–ø–∏—Å–∞—Ç—å Compute Shader –¥–ª—è Resize (512x512) –∏ Normalization (mean/std).1818–ù–µ–¥–µ–ª—è 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –í–∞–ª–∏–¥–∞—Ü–∏—è3.1 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (Android)–í–∫–ª—é—á–∏—Ç—å GPU Delegate (TfLiteDelegate GpuDelegateV2 = new GpuDelegateV2()) –≤ SegmentationPlugin.java. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.20203.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –í–∞–ª–∏–¥–∞—Ü–∏–µ–π–í–Ω–µ–¥—Ä–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–°–µ–∫—Ü–∏—è V.D) –≤ ShouldProcessPlane (–ø–æ—Å–ª–µ –≠—Ç–∞–ø–∞ 2).3.3 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ UX–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (FPS, VRAM). –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ "–±–µ–ª—ã—Ö —Å—Ç–µ–Ω–∞—Ö".2222B. –¢–∞–±–ª–∏—Ü–∞ 3: –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–∞—è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (A15 GPU) –∏ –í–ª–∏—è–Ω–∏–µ–ú–µ—Ç—Ä–∏–∫–∞–≠—Ç–∞–ø 1 (–≠–≤—Ä–∏—Å—Ç–∏–∫–∞)–≠—Ç–∞–ø 1+2 (–ì–ª—É–±–∏–Ω–∞)–≠—Ç–∞–ø 1+2+3 (ML)–¢–æ—á–Ω–æ—Å—Ç—å (Precision)~70% (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç –¥–≤–µ—Ä–∏)~95% (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç –ø–ª–æ—Å–∫–∏–µ –¥–≤–µ—Ä–∏)>98%–ü–æ–ª–Ω–æ—Ç–∞ (Recall)~70% (–æ—Ç—Å–µ—á–µ—Ç –º–∞–ª. —Å—Ç–µ–Ω—ã)~65% (–æ—Ç—Å–µ—á–µ—Ç –º–∞–ª. —Å—Ç–µ–Ω—ã)~65%FPS (iPhone 13)60 FPS~55-60 FPS~45-50 FPS (—Å ML –Ω–∞ 5 FPS)–†–∞–∑–º–µ—Ä –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è+0 –ú–ë+0.1 –ú–ë (Compute Shader)+50-70 –ú–ë (–º–æ–¥–µ–ª—å TFLite/CoreML)–í—Ä–µ–º—è –í–Ω–µ–¥—Ä–µ–Ω–∏—è< 1 –¥–µ–Ω—å< 1 –Ω–µ–¥–µ–ª—è+2-3 –Ω–µ–¥–µ–ª–∏–†–∏—Å–∫–∏–í—ã—Å–æ–∫–∏–π False Positive–ü—Ä–æ–±–ª–µ–º–∞ "–ø–ª–æ—Å–∫–∏—Ö" –æ–±—ä–µ–∫—Ç–æ–≤"–ë–µ–ª—ã–µ —Å—Ç–µ–Ω—ã" 22, —Å–ª–æ–∂–Ω–æ—Å—Ç—å Android-–ø–æ—Ä—Ç–∞VII. –ò–¢–û–ì–û–í–´–ï –û–¢–í–ï–¢–´, –ö–û–ú–ü–†–û–ú–ò–°–°–´ –ò –£–ü–†–ê–í–õ–ï–ù–ò–ï –†–ò–°–ö–ê–ú–òA. –û—Ç–≤–µ—Ç—ã –Ω–∞ 7 –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –í–æ–ø—Ä–æ—Å–æ–≤–î–∏–∞–≥–Ω–æ–∑ 0.51 –º¬≤: –≠—Ç–æ –Ω–µ –±–∞–≥ —Ñ–∏–ª—å—Ç—Ä–∞. –≠—Ç–æ –æ—à–∏–±–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –≤ OnPlanesChanged. –ü–ª–æ—Å–∫–æ—Å—Ç—å –±—ã–ª–∞ >1.0 –º¬≤, –ø—Ä–æ—à–ª–∞ —Ñ–∏–ª—å—Ç—Ä, –∞ –∑–∞—Ç–µ–º –±—ã–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (args.updated) –¥–æ 0.51 –º¬≤. –í–∞—à –∫–æ–¥ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª —ç—Ç–æ "—É–º–µ–Ω—å—à–µ–Ω–∏–µ" –∏ –Ω–µ —É–¥–∞–ª–∏–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—É—é –ø–ª–æ—Å–∫–æ—Å—Ç—å. (–°–º. –°–µ–∫—Ü–∏—é II).–ü—Ä–∏–æ—Ä–∏—Ç–µ–∑–∞—Ü–∏—è –†–µ—à–µ–Ω–∏–π: –†–µ—à–µ–Ω–∏–µ C (–ì–∏–±—Ä–∏–¥), –Ω–æ –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏: –≠—Ç–∞–ø 1 (–≠–≤—Ä–∏—Å—Ç–∏–∫–∞) + –≠—Ç–∞–ø 2 (–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ –ì–ª—É–±–∏–Ω–µ) + –≠—Ç–∞–ø 3 (ML –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è). –≠—Ç–∞–ø—ã 1 –∏ 2 —Ä–µ—à–∞—Ç 95% –≤–∞—à–∏—Ö –ø—Ä–æ–±–ª–µ–º –∑–∞ <1 –Ω–µ–¥–µ–ª—é, –Ω–µ —Ç—Ä–µ–±—É—è ML.–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ö–æ–¥: –ö–æ–¥ –¥–ª—è –≠—Ç–∞–ø–∞ 1 (C# –≠–≤—Ä–∏—Å—Ç–∏–∫–∞) –∏ –≠—Ç–∞–ø–∞ 2 (C# + Compute Shader –¥–ª—è –ì–ª—É–±–∏–Ω—ã) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –°–µ–∫—Ü–∏—è—Ö III –∏ IV.–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –¢–∞–±–ª–∏—Ü–µ 1 (–°–µ–∫—Ü–∏—è III.C). –ö–ª—é—á–µ–≤—ã–µ: minWallArea = 2.5f –∏ minAspectRatio = 0.3f.Trade-offs (–ö–æ–º–ø—Ä–æ–º–∏—Å—Å—ã):–í—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–Ω—è—Ç—å —Å–Ω–∏–∂–µ–Ω–∏–µ Recall (–ø–æ–ª–Ω–æ—Ç—ã). –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (–≠—Ç–∞–ø 1) –±—É–¥–µ—Ç –æ—Ç—Å–µ–∫–∞—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–µ, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏ —Å—Ç–µ–Ω. –≠—Ç–æ –ø—Ä—è–º–æ–µ —Å–ª–µ–¥—Å—Ç–≤–∏–µ –≤–∞—à–µ–≥–æ –≥–ª–∞–≤–Ω–æ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (–¢–æ—á–Ω–æ—Å—Ç—å > –ü–æ–ª–Ω–æ—Ç–∞).–≠—Ç–∞–ø 2 (–ì–ª—É–±–∏–Ω–∞) –Ω–µ –æ—Ç—Å–µ—á–µ—Ç –æ–±—ä–µ–∫—Ç—ã, –∏–¥–µ–∞–ª—å–Ω–æ –ø—Ä–∏–ª–µ–≥–∞—é—â–∏–µ –∫ —Å—Ç–µ–Ω–µ (–∫–∞—Ä—Ç–∏–Ω—ã, –¥–≤–µ—Ä–∏ –≤—Ä–æ–≤–µ–Ω—å).–≠—Ç–∞–ø 3 (ML) –±—É–¥–µ—Ç —Å—Ç–æ–∏—Ç—å 50-70 –ú–ë —Ä–∞–∑–º–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ ~10-15 FPS.Roadmap (ML): –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –¢–∞–±–ª–∏—Ü–µ 2 (–°–µ–∫—Ü–∏—è VI.A). –≠—Ç–æ –¥–µ—Ç–∞–ª—å–Ω—ã–π 3-–Ω–µ–¥–µ–ª—å–Ω—ã–π –ø–ª–∞–Ω.–†–∏—Å–∫–∏ –∏ –ú–∏—Ç–∏–≥–∞—Ü–∏—è:–†–∏—Å–∫ 1: "–ü—Ä–æ–±–ª–µ–º–∞ –ë–µ–ª—ã—Ö –°—Ç–µ–Ω".22 ARKit —Ç—Ä–µ–±—É–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π (—Ç–µ–∫—Å—Ç—É—Ä—ã) –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–ª–æ—Å–∫–æ—Å—Ç–µ–π. –ß–∏—Å—Ç—ã–µ, –±–µ–ª—ã–µ, –æ–¥–Ω–æ—Ç–æ–Ω–Ω—ã–µ —Å—Ç–µ–Ω—ã ‚Äî –µ–≥–æ –∫—Ä–∏–ø—Ç–æ–Ω–∏—Ç.–ú–∏—Ç–∏–≥–∞—Ü–∏—è: UX. –í—ã –¥–æ–ª–∂–Ω—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ UI –ø–æ–¥—Å–∫–∞–∑–∫–∏: "–ú–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–æ–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä–æ–π, –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—è —É–≥–ª—ã –∫–æ–º–Ω–∞—Ç—ã, –ø–æ–ª –∏ –ø–æ—Ç–æ–ª–æ–∫". ARKit –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã (–ø–æ–ª/—Å—Ç–µ–Ω–∞) –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –ø–ª–æ—Å–∫–æ—Å—Ç–µ–π.–†–∏—Å–∫ 2: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ML –Ω–∞ Android. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ TFLite —Å GPU Delegate 21 ‚Äî –Ω–µ—Ç—Ä–∏–≤–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ —Å—Ä–µ–¥–Ω–µ–º Android-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –±—É–¥–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ, —á–µ–º –Ω–∞ A15 GPU.–ú–∏—Ç–∏–≥–∞—Ü–∏—è: –ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è Android (Snapdragon 8 Gen 1+ –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏) –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è ML-—Ñ–∏—á–∏.–†–∏—Å–∫ 3: –¢–æ—á–Ω–æ—Å—Ç—å –ì–æ—Ç–æ–≤–æ–π –ú–æ–¥–µ–ª–∏. –ú–æ–¥–µ–ª—å ADE20K 5 –º–æ–∂–µ—Ç –ø—É—Ç–∞—Ç—å wall –∏ ceiling (–ø–æ—Ç–æ–ª–æ–∫).–ú–∏—Ç–∏–≥–∞—Ü–∏—è: –í –∞–ª–≥–æ—Ä–∏—Ç–º–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–°–µ–∫—Ü–∏—è V.D) –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∫–ª–∞—Å—Å—ã wall –ò ceiling –∫–∞–∫ –≤–∞–ª–∏–¥–Ω—ã–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞—Ö–æ—Ç–µ—Ç—å –ø–æ–∫—Ä–∞—Å–∏—Ç—å –∏ –ø–æ—Ç–æ–ª–æ–∫).B. –§–∏–Ω–∞–ª—å–Ω–∞—è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–°–µ–≥–æ–¥–Ω—è/–ó–∞–≤—Ç—Ä–∞): –í–Ω–µ–¥—Ä–∏—Ç–µ –≠—Ç–∞–ø 1 (–≠–≤—Ä–∏—Å—Ç–∏–∫–∞) (–°–µ–∫—Ü–∏—è III). –≠—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç –≤–∞—à –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥ 0.51 –º¬≤ –∏ –æ—Ç—Å–µ—á–µ—Ç 70% –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (–¥–≤–µ—Ä–∏, –∫–æ—Å—è–∫–∏) –∑–∞ —Å—á–µ—Ç minWallArea = 2.5f –∏ minAspectRatio = 0.3f.–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ (< 1 –ù–µ–¥–µ–ª–∏): –í–Ω–µ–¥—Ä–∏—Ç–µ –≠—Ç–∞–ø 2 (–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ –ì–ª—É–±–∏–Ω–µ) (–°–µ–∫—Ü–∏—è IV). –≠—Ç–æ –≤–∞—à "—Å–µ—Ä–µ–±—Ä—è–Ω—ã–π —Å–Ω–∞—Ä—è–¥" ‚Äî –¥–µ—à–µ–≤–æ, –±—ã—Å—Ç—Ä–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–º–µ—é—â–µ–µ—Å—è API 24 –∏ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –º–µ–±–µ–ª–∏/—Ä–µ–ª—å–µ—Ñ–∞ (Image 6, 4).–û—Ü–µ–Ω–∫–∞: –ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≠—Ç–∞–ø–∞–º–∏ 1+2. –ï—Å–ª–∏ False Positive Rate (–ø—Ä–æ—Ü–µ–Ω—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–≤–µ—Ä–µ–π/—à–∫–∞—Ñ–æ–≤) –≤—Å–µ –µ—â–µ –≤—ã—à–µ 5-10%, –ø—Ä–∏—Å—Ç—É–ø–∞–π—Ç–µ –∫ –≠—Ç–∞–ø—É 3 (ML).